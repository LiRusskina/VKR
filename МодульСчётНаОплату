&НаКлиенте
Процедура ОплатаНоменклатураПриИзменении(Элемент)
	СтрокаТабличнойЧасти = Элементы.Оплата.ТекущиеДанные;
	СтрокаТабличнойЧасти.Цена = РаботаСоСправочниками.ЦенаУслуги(Объект.Дата,
	СтрокаТабличнойЧасти.Номенклатура);
КонецПроцедуры

&НаКлиенте
Процедура ОплатаНДСПриИзменении(Элемент)
	ТекущиеДанные = Элементы.Оплата.ТекущиеДанные;
	НДС20 = ПредопределенноеЗначение("Перечисление.СтавкиНДС.НДС20");
	БезНДС = ПредопределенноеЗначение("Перечисление.СтавкиНДС.БезНДС");
	Если ТекущиеДанные.НДС = НДС20 Тогда
		ТекущиеДанные.СуммаСНДС = ТекущиеДанные.Цена * 1.2; 
		ТекущиеДанные.НДСОтСуммы = ТекущиеДанные.Цена * 0.2;
	ИначеЕсли ТекущиеДанные.НДС = БезНДС Тогда
		ТекущиеДанные.СуммаСНДС = ТекущиеДанные.Цена; 
		ТекущиеДанные.НДСОтСуммы = 0;
	КонецЕсли;
КонецПроцедуры

&НаСервере 
Функция ПолучитьБанковскийСчёт(БанковскийСчёт, ТекущийПлательщик)
    Запрос = Новый Запрос;
     Запрос.Текст =
	"ВЫБРАТЬ
	|	БанковскиеСчета.НомерСчёта КАК НомерСчёта
	|ИЗ
	|	Справочник.БанковскиеСчета КАК БанковскиеСчета
	|ГДЕ
	|	БанковскиеСчета.Владелец = &Владелец";
     Запрос.УстановитьПараметр("Владелец", ТекущийПлательщик);
    ВыборкаДетальныеЗаписи = Запрос.Выполнить().Выбрать();
    Если ВыборкаДетальныеЗаписи.Следующий() Тогда
     Возврат  ВыборкаДетальныеЗаписи.НомерСчёта; 
Иначе
    Возврат 0;
КонецЕсли;      
КонецФункции

&НаКлиенте
Процедура ПередЗаписью(Отказ, ПараметрыЗаписи)
	Объект.БанковскийСчёт = ПолучитьБанковскийСчёт(Объект.БанковскийСчёт, Объект.Плательщик);
КонецПроцедуры
